


<div class="row">
  <div class="col-sm-6">
    <h1>Hospitals</h1>
    <p class="lead">
      Hospitals can register, once their account is validated by our team they will be able to quickly sent print orders to hospitals.
    </p>
  </div>

  <div>
    <div id="map" style='width: 800px; height: 400px;'></div>
  </div>

  <div class="col-sm-6 text-right">
  <%= link_to new_hospital_path, class: 'btn btn-primary' do %>
    Add New Hospital
  <% end %>
  </div>
</div>

<div class="table-responsive">
  <table class="table table-striped table-bordered table-hover">
    <thead>
      <tr>
        <th>Name</th>
        <th>Location</th>
        <th>Full address</th>
        <th>GPS coordinates</th>
        <th>Map</th>
        <th>Phone</th>
        <th>Email</th>
        <th>Administrative contact name</th>
        <th>Administrative contact email</th>
      </tr>
    </thead>

    <tbody>
      <% @hospitals.each do |hospital| %>
        <%= content_tag :tr, id: dom_id(hospital), class: dom_class(hospital) do %>
          <td><%= link_to hospital.name, hospital %></td>
          <td><%= hospital.location %></td>
          <td><%= hospital.full_address %></td>
          <td><p>GPS: [<%= hospital.latitude %>, <%= hospital.longitude %>]</p></td>
          <td><%= image_tag google_map([ hospital.latitude, hospital.longitude ].join(',')),
              class: 'img-fluid img-rounded', alt: "#{hospital.name} on the map" %></td>
          <td><%= hospital.phone %></td>
          <td><%= hospital.email %></td>
          <td><%= hospital.administrative_contact_name %></td>
          <td><%= hospital.administrative_contact_email %></td>
        <% end %>
      <% end %>
    </tbody>
  </table>
</div>

<script>
  markers = handler.addMarkers(<%=raw @hash.to_json %>);
  handler = Gmaps.build('Google');
  handler.buildMap({
      provider: {
        disableDefaultUI: true
        // pass in other Google Maps API options here
      },
      internal: {
        id: 'map'
      }
    },
    function(){
      markers = handler.addMarkers([
        {
          "lat": 0,
          "lng": 0,
          "picture": {
            "url": "http://people.mozilla.com/~faaborg/files/shiretoko/firefoxIcon/firefox-32.png",
            "width":  32,
            "height": 32
          },
          "infowindow": "hello!"
        }
      ]);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
    }
  );
</script>